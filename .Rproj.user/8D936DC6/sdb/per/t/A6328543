{
    "contents" : "library(shiny)\nlibrary(shinydashboard)\nlibrary(rCharts)\nlibrary(rjson)\nlibrary(dplyr)\n\nshinyServer(function(input, output) {\n  \n  suspcatYear <- reactive({\n  \n     df <- suspcatbyYear %>%\n       filter(YEAR == input$year)\n   \n  })\n  \n  suspcatTypeYear <- reactive({\n    \n    df <- suspcatTypebyYear %>%\n      filter(YEAR == input$year)  \n  })\n  \n  ADD_suspcatYear <- reactive({\n    \n    df <- suspcatbyYear %>%\n      filter(YEAR == input$ADDyear)\n    \n  })\n  \n  ###SUSPICIOUS ACTIVITY CATEGORY TOTALS BY YEAR\n  output$activityCat <- renderChart2({\n \n    x <-  suspcatYear()\n \n    a <- hPlot(x = \"SUSPICIOUS_ACTIVITY_CATEGORY\", y = \"NUMBER_OF_FILINGS\", data = x, type = \"pie\")\n    a$title(text = \"Number of Filings by Suspicious Activity Category\")\n    a$plotOptions(width=600, height=400)\n    a$tooltip(shared = TRUE)\n    a$exporting(enabled = T)\n    a$addParams(dom = \"activityCat\")\n  \n    return(a)\n \n  })\n  \n  output$activityType <- renderChart2({\n\n    x <-  suspcatTypeYear()\n    y <- input$year\n    x <- x[x$YEAR == y, ]\n    data <- x[x$SUSPICIOUS_ACTIVITY_CATEGORY %in% input$suspCat,]\n \n    \n    d1 <- dPlot(\n      SUSPICIOUS_ACTIVITY_TYPE ~ NUMBER_OF_FILINGS,\n      groups = \"SUSPICIOUS_ACTIVITY_CATEGORY\",\n      data = data,\n      type = \"bar\",\n      width = 1200,\n      bounds = list(x=450, y=35, width=800, height=300)\n    )\n    d1$xAxis(size = 8, type = \"addMeasureAxis\", outputFormat=\"#,\")\n    d1$yAxis(size = 8, type = \"addCategoryAxis\", orderRule = \"SUSPICIOUS_ACTIVITY_TYPE\")\n    d1$legend(\n      x = 0,\n      y = 5,\n      width = 800,\n      height = 20,\n      horizontalAlign = \"right\"\n    )\n    return(d1)\n    \n    \n  })\n  \n  \n  ###MONTH TOTALS BY YEAR\n  output$activityMonth <- renderChart2({\n    \n    x <- monthYear\n    y <- input$year\n    x <- x[x$YEAR == y, ]\n    \n    a <- hPlot(NUMBER_OF_FILINGS ~ MONTH, data = x, type = \"column\")\n    a$title(text = \"Number of Filings by Month\")\n    a$tooltip(shared = TRUE)\n    a$exporting(enabled = T)\n    a$addParams(dom = \"activityMonth\")\n    \n    return(a)\n    \n  })\n  \n  ###STATE TOTALS BY YEAR\n  output$activityState <- renderChart2({\n    \n    sel <- input$states\n    x <- stateYear\n    y <- input$year\n    x <- x[x$YEAR == y, ]\n    data <- x[x$STATE %in% sel,]\n    \n    a <- hPlot(NUMBER_OF_FILINGS ~ STATE, data = data, type = \"column\")\n    a$title(text = \"Number of Filings by State\")\n    a$tooltip(shared = TRUE)\n    a$exporting(enabled = T)\n    a$addParams(height = 300, dom = \"activityState\")\n    \n    return(a)\n   \n  })\n  \n  ###GAMING TOTALS BY YEAR\n  output$activityGaming <- renderChart2({\n    \n    x <- gamingYear\n    y <- input$ADDyear\n    x <- x[x$YEAR == y, ]\n    \n    a <- hPlot(x = \"TYPE_OF_GAMING_ESTABLISHMENT\", y = \"NUMBER_OF_FILINGS\", data = x, type = \"pie\")\n    a$title(text = \"Number of Filings by Gaming Establishment\")\n    a$tooltip(shared = TRUE)\n    a$exporting(enabled = T)\n    a$addParams(dom = \"activityGaming\")\n    \n    return(a)\n    \n    \n  })\n  \n  ###PAYMENT TOTALS BY YEAR\n  output$activityPayment <- renderChart2({\n    \n    x <- paymentYear\n    y <- input$ADDyear\n    x <- x[x$YEAR == y, ]\n    \n    a <- hPlot(x = \"PAYMENT_INSTRUMENT_TYPE\", y = \"NUMBER_OF_FILINGS\", data = x, type = \"pie\")\n    a$title(text = \"Number of Filings by Payment Type\")\n    a$tooltip(shared = TRUE)\n    a$exporting(enabled = T)\n    a$addParams(dom = \"activityPayment\")\n    \n    return(a)\n    \n  })\n  \n  ##### DATA TABLES #####\n  \n  output$suspCatType <- renderDataTable(suspcatTypebyYear, options = list(pageLength = 10))\n  \n  output$month <- renderDataTable(monthYear, options = list(pageLength = 10))\n  \n  output$state <- renderDataTable(stateYear, options = list(pageLength = 10))\n  \n  output$gaming <- renderDataTable(gamingYear, options = list(pageLength = 10))\n  \n  output$payment <- renderDataTable(paymentYear, options = list(pageLength = 10))\n \n})",
    "created" : 1411690863127.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3330804907",
    "id" : "A6328543",
    "lastKnownWriteTime" : 1424552110,
    "path" : "~/GitHub/ShinyDashboard_Fincen/server.R",
    "project_path" : "server.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}